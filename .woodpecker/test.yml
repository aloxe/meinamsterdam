when:
#  - event: manual #secret "USERNAME" is not allowed to be used with pipeline event "manual"
  - event: push
    branch: test
steps:
  - name: Use Node et ğŸ› ï¸ Install 
    image: node
    commands:
     - npm install
     - npm run build

  - name: check a boo
    image: debian
    commands:
      - echo "Testing ..."
      - ls -al

  - name: scp files (â•¯ Í¡Â° ÍœÊ– Í¡Â°ï¼‰â•¯ï¼/â”´â”¬â”´â”¬â”´ 
    image: appleboy/drone-scp
    settings:
      host: 
        from_secret: HOST
      user: 
        from_secret: USERNAME
      key:
        from_secret: KEY
      target: ~/domains/test.xn--4lj4bfp6d.eu.org/public_html/
      source: _site/*
      strip_components: 1
      rm: true

      # - name: Copy htaccess to site
      #   run: ssh staging "cd ~/domains/test.xn--4lj4bfp6d.eu.org/homes/; cp .htaccess ../public_html/"
      #   not needed since we use nginx